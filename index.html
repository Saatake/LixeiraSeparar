<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Controle da Lixeira</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    button {
      margin: 10px;
      padding: 15px 25px;
      font-size: 18px;
      cursor: pointer;
    }
    .item {
      margin-top: 20px;
      text-align: center;
    }
    .item img {
      width: 100px;
      height: 100px;
    }
    .item button {
      margin-top: 10px;
    }
    #pontos {
      font-size: 24px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>Controle da Lixeira</h1>
  <div id="pontos">Carregando pontos...</div>
  <button onclick="enviarComando('reciclavel')">Reciclável</button>
  <button onclick="enviarComando('organico')">Orgânico</button>

  <div id="loja">
    <h2>Lojinha de Prêmios</h2>
    <div class="item">
      <img src="item1.jpg" alt="Item 1">
      <button onclick="comprarItem(30)">Comprar por 30 pontos</button>
    </div>
    <div class="item">
      <img src="item2.jpg" alt="Item 2">
      <button onclick="comprarItem(80)">Comprar por 80 pontos</button>
    </div>
    <div class="item">
      <img src="item3.jpg" alt="Item 3">
      <button onclick="comprarItem(120)">Comprar por 120 pontos</button>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    // Configuração do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCFOh6xEHlS_yuC9Rp3u8hdaUmZrn-uPPA",
      authDomain: "upx2-99a8e.firebaseapp.com",
      databaseURL: "https://upx2-99a8e-default-rtdb.firebaseio.com",
      projectId: "upx2-99a8e",
      storageBucket: "upx2-99a8e.firebasestorage.app",
      messagingSenderId: "441113316559",
      appId: "1:441113316559:web:c26cf7fccac53abb40bbba"
    };

    // Inicializar Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    let pontos = 0; // Variável para armazenar os pontos

    // Função para carregar pontos
    function carregarPontos() {
      database.ref("/usuario").on("value", (snapshot) => {
        if (snapshot.exists()) {
          pontos = snapshot.val().pontos;
          document.getElementById("pontos").innerText = `Você tem ${pontos} pontos`;
        }
      });
    }

    // Função para comprar item
    function comprarItem(custo) {
      if (pontos >= custo) {
        pontos -= custo; // Subtrai os pontos localmente
        database.ref("/usuario").update({ pontos }) // Atualiza no Firebase
          .then(() => {
            alert(`Compra realizada! Você agora tem ${pontos} pontos.`);
            document.getElementById("pontos").innerText = `Você tem ${pontos} pontos`;
          })
          .catch((error) => {
            console.error("Erro ao atualizar pontos no Firebase:", error);
          });
      } else {
        alert("Pontos insuficientes para esta compra.");
      }
    }

    // Função para enviar comandos
    function enviarComando(comando) {
      database.ref("/").update({
        comando: comando
      })
      .then(() => {
        console.log("Comando enviado: " + comando);
      })
      .catch((error) => {
        console.error("Erro ao enviar comando: ", error);
      });
    }

    // Carregar os pontos na inicialização
    carregarPontos();
  </script>
</body>
</html>
